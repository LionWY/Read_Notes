# 以自动释放池降低内存峰值
> 自动释放池用于存放那些需要在稍后某个时刻释放的对象。清空（drain）自动释放池时，系统会向其中的对象发送`release`消息

1. 系统会自动创建一些线程，比如主线程或GCD中的线程，这些线程默认都有自动释放池，每次执行事件循环时，都会将其清空。

2. 主main函数的自动释放池包裹应用程序的主入口点（main application entry point），是最外围捕获自动释放对象所用的池。

3. 当循环创建了大量对象时，应该在循环内创建`autoreleasepool`，这样在每次进行循环的时候就会创建自动释放池，并且把新建的对象放在池中，使用完之后，在块的末尾把对象回收。

4. 内存峰值（high-memory waterline）是指应用程序在某个特定时间段内的最大内存用量（highest memory footprint）。

5. 自动释放池机制就像栈一样。系统创建好自动释放池后，就将其推入栈中，而清空自动释放池，则相当于将其从栈中弹出。在对象上执行自动释放操作，就等于将其放入栈顶的那个池里。

6. `@autoreleasepool`要视情况使用，当内存用量没达到需要优化的程度，尽量不要创建额外的自动释放池。

7. `NSAutoreleasePool`通过用来创建那种偶尔需要清空的池，相比`@autoreleasepool`更为重量级。

8. `NSAutoreleasePool`是通过`init`和`drain`来限定范围的，不如`@autoreleasepool{}`显而易见。



## 总结：

***1. 自动释放池排布在栈中，对象收到autorelease消息后，系统将其放入最顶端的池里***

***2. 合理运用自动释放池，可降低应用程序的内存峰值***

***3. `@autoreleasepool`能创建更为轻便的自动释放池***



